<!DOCTYPE html> 
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Billy Bob's Spin-O-Matic!</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      font-family: "Trebuchet MS", system-ui, sans-serif;
      background: #F8EDE3;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      color: #2A4C7F;
    }

    .wrapper {
      max-width: 480px;
      padding: 12px 16px 16px;
    }

    .game-header {
      width: 320px;
      max-width: 100%;
      margin: 10px auto 0;
      display: block;
    }

    .wheel-container {
      position: relative;
      width: min(320px, 80vw);
      margin: -30px auto 8px;
    }

    #wheel {
      width: 100%;
      height: auto;
      display: block;
      transform: rotate(0deg);
      transition: transform 4s cubic-bezier(0.25, 0.1, 0.25, 1);
    }

    .arrow-overlay {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      width: 90px;
      top: -18%;
      z-index: 5;
      pointer-events: none;
    }

    .whirl-btn {
      width: 260px;
      max-width: 90%;
      cursor: pointer;
      margin: 6px auto 0;
      display: block;
    }

    .result {
      margin-top: 14px;
      font-size: 1rem;
      min-height: 3em;
      line-height: 1.4;
      color: #2A4C7F;
    }

    .tagline {
      margin-top: 12px;
      font-size: 0.9rem;
      color: #7a6c5d;
    }

    .round {
      margin-top: 8px;
      font-size: 0.85rem;
      color: #7a6c5d;
    }
  </style>
</head>

<body>

  <div class="wrapper">

    <img
      src="https://www.billybobsparlour.com/wp-content/uploads/2025/12/game-header.png"
      alt="Billy Bob's Spin-O-Matic"
      class="game-header"
    >

    <div class="wheel-container">
      <img
        id="wheel"
        src="https://www.billybobsparlour.com/wp-content/uploads/2025/12/Wheel.png"
        alt="Spin Wheel"
      >
      <img
        class="arrow-overlay"
        src="https://www.billybobsparlour.com/wp-content/uploads/2025/12/Arrow.png"
        alt="Pointer"
      >
    </div>

    <img
      id="spinButton"
      src="https://www.billybobsparlour.com/wp-content/uploads/2025/12/Give-it-a-whirl.png"
      alt="Give it a whirl"
      class="whirl-btn"
    >

    <div id="roundInfo" class="round"></div>

    <div id="result" class="result"></div>

    <p class="tagline">Billy Bob's — tastes like happiness!</p>
  </div>

  <script>
    const wheel = document.getElementById("wheel");
    const spinButton = document.getElementById("spinButton");
    const resultDiv = document.getElementById("result");
    const roundInfo = document.getElementById("roundInfo");

    // ---------- Helpers ----------
    function shuffle(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    function hr() {
      return "<hr style='border:none;border-top:1px solid #ddd;margin:10px 0;'>";
    }

    // ---------- Pools ----------
    const crazyLaws = [
      {
        law: "In Alabama, it's illegal to walk around with an ice-cream cone in your back pocket.",
        reason: "WHY? Because sneaky people once used this trick to lure horses away without officially stealing them!"
      },
      {
        law: "In Arizona, it's illegal for a donkey to sleep in a bathtub.",
        reason: "WHY? A rancher’s donkey once floated away during a flood while snoozing in an old tub!"
      },
      {
        law: "In Louisiana, you're not allowed to tie an alligator to a fire hydrant.",
        reason: "WHY? Fire hydrants must NEVER be blocked by anything — vehicles, objects, or animals. Firefighters need instant access in emergencies."
      },
      {
        law: "In Maine, it’s against the law to step out of a plane while it’s flying.",
        reason: "WHY? Believe it or not, someone tried it — so lawmakers decided to make things crystal clear!"
      },
      {
        law: "In Alabama, it’s illegal to wear a fake moustache that causes laughter in church.",
        reason: "WHY? Church services were meant to be calm and respectful, and prank disguises were banned to stop disruptions."
      },
      {
        law: "If an elephant is tied to a parking meter, the parking fee must be paid.",
        reason: "WHY? Circuses brought elephants into town, and leaders decided anything taking up street space should follow parking rules."
      },
      {
        law: "In Baltimore, Maryland, it’s illegal to take a lion to the movies.",
        reason: "WHY? Some animals are simply too dangerous — and distracting — for public places like theaters."
      },
      {
        law: "In New Jersey, it’s illegal to slurp soup.",
        reason: "WHY? Slurping was considered very rude in public, and this law encouraged good table manners."
      },
      {
        law: "In Oklahoma, it’s illegal to take a bite out of someone else’s hamburger.",
        reason: "WHY? Because grabbing someone else’s food — even as a joke — counts as stealing."
      }
    ];

    // Shared tongue-twister pool (so your 3 tongue-twister segments don't repeat each other)
    const tongueTwisters = [
      "Milkshake makers mix mighty fast.",
      "Hot dogs hop from grill to bun.",
      "Billy Bob’s burgers in buns bite big."
      // Add more here later!
    ];

    // States challenge pool (so “States Showdown” varies instead of always the same prompt)
    const stateChallenges = [
      "Take turns naming U.S. states — no repeats! First person to hesitate is out.",
      "Take turns naming U.S. state capitals — no repeats! (You can pass once.)",
      "Take turns naming U.S. states that start with a vowel (A, E, I, O, U). No repeats!",
      "Take turns naming U.S. states with TWO words (like New York). No repeats!",
      "Name as many U.S. states as you can in 20 seconds as a table — go!"
      // Add more here later!
    ];

    // ---------- Segments ----------
    const segments = [
      {
        label: "Ice Cream Flavour Frenzy",
        text: "Take turns naming ice cream flavours — no repeats! First person to hesitate is out."
      },
      {
        label: "Pancake Toppings Dash",
        text: "In 15 seconds, how many pancake toppings can you name as a table? Quickfire round!"
      },
      {
        label: "Milkshake Tongue Twister",
        text: () => getNextTwistersHTML()
      },
      {
        label: "Hot Dog Tongue Twister",
        text: () => getNextTwistersHTML()
      },
      {
        label: "Burger Bite Tongue Twister",
        text: () => getNextTwistersHTML()
      },
      {
        label: "Billy Bob’s Memory Game",
        text: "Start with: ‘I went to Billy Bob’s and I had…’ Each person repeats the list AND adds one new item."
      },
      {
        label: "States Showdown",
        text: () => getNextStateChallengesHTML()
      },
      {
        label: "Guess the Food",
        text: "Someone secretly picks a Billy Bob’s food item. Everyone else asks yes/no questions until someone guesses it!"
      },
      {
        label: "Crazy U.S. Law!",
        text: () => getNextLawsHTML()
      }
    ];

    const segmentCount = segments.length;
    const segmentAngle = 360 / segmentCount;

    // Pro-rata: how many items to show per hit of a pooled segment
    function itemsPerHit(poolLength) {
      return Math.max(1, Math.round(poolLength / segmentCount));
    }

    // ---------- Segment bag (no repeats until all segments used; then reshuffle and continue) ----------
    let segmentBag = [];
    let round = 0;

    function refillSegmentBag() {
      segmentBag = shuffle([...Array(segmentCount).keys()]);
      round += 1;
      roundInfo.textContent = `Round ${round} — you’ll see every segment once in ${segmentCount} spins.`;
    }

    function nextSegmentIndex() {
      if (segmentBag.length === 0) refillSegmentBag();
      return segmentBag.pop();
    }

    // ---------- Law bag (no repeats until used up; refills when empty) ----------
    let lawBag = [];
    function refillLawBag() {
      lawBag = shuffle([...Array(crazyLaws.length).keys()]);
    }
    function nextLawIndex() {
      if (lawBag.length === 0) refillLawBag();
      return lawBag.pop();
    }
    function getNextLawsHTML() {
      const count = itemsPerHit(crazyLaws.length);
      const picks = [];
      for (let i = 0; i < count; i++) {
        const item = crazyLaws[nextLawIndex()];
        picks.push(`${item.law}<br><em>${item.reason}</em>`);
      }
      return picks.join(hr());
    }

    // ---------- Tongue twister bag (shared across all tongue twister segments) ----------
    let twisterBag = [];
    function refillTwisterBag() {
      twisterBag = shuffle([...Array(tongueTwisters.length).keys()]);
    }
    function nextTwisterIndex() {
      if (twisterBag.length === 0) refillTwisterBag();
      return twisterBag.pop();
    }
    function getNextTwistersHTML() {
      const count = itemsPerHit(tongueTwisters.length);
      const picks = [];
      for (let i = 0; i < count; i++) {
        const t = tongueTwisters[nextTwisterIndex()];
        picks.push(`Try saying this 3 times fast: ‘${t}’`);
      }
      return `${picks.join(hr())}<br>Take turns!`;
    }

    // ---------- State challenge bag ----------
    let stateBag = [];
    function refillStateBag() {
      stateBag = shuffle([...Array(stateChallenges.length).keys()]);
    }
    function nextStateIndex() {
      if (stateBag.length === 0) refillStateBag();
      return stateBag.pop();
    }
    function getNextStateChallengesHTML() {
      const count = itemsPerHit(stateChallenges.length);
      const picks = [];
      for (let i = 0; i < count; i++) {
        picks.push(stateChallenges[nextStateIndex()]);
      }
      return picks.join(hr());
    }

    // Init bags
    refillSegmentBag();
    refillLawBag();
    refillTwisterBag();
    refillStateBag();

    // ---------- Spin logic ----------
    let isSpinning = false;
    let currentRotation = 0;

    spinButton.addEventListener("click", () => {
      if (isSpinning) return;
      isSpinning = true;
      resultDiv.textContent = "";

      const chosenIndex = nextSegmentIndex();
      const fullTurns = 5;

      const chosenCenterAngle = chosenIndex * segmentAngle + segmentAngle / 2;
      const targetAngle = 360 - chosenCenterAngle;

      const base = currentRotation % 360;
      let diff = targetAngle - base;
      if (diff < 0) diff += 360;

      const stopAngle = currentRotation + fullTurns * 360 + diff;
      currentRotation = stopAngle;

      wheel.style.transition = "transform 4s cubic-bezier(0.25, 0.1, 0.25, 1)";
      wheel.style.transform = `rotate(${stopAngle}deg)`;

      wheel.addEventListener(
        "transitionend",
        () => {
          const seg = segments[chosenIndex];
          const resultText = typeof seg.text === "function" ? seg.text() : seg.text;
          resultDiv.innerHTML = `<strong>${seg.label}</strong><br>${resultText}`;
          isSpinning = false;

          // Prevent rotation number growing huge over time
          setTimeout(() => {
            wheel.style.transition = "none";
            currentRotation = currentRotation % 360;
            wheel.style.transform = `rotate(${currentRotation}deg)`;
            void wheel.offsetWidth;
            wheel.style.transition = "transform 4s cubic-bezier(0.25, 0.1, 0.25, 1)";
          }, 50);
        },
        { once: true }
      );
    });
  </script>

</body>
</html>
